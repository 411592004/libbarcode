#!/usr/bin/env ruby

values = [
   0b101100110,
   0b100110110,
   0b100110011,
   0b001001100,
   0b001000110,
   0b000100110,
   0b001100100,
   0b001100010,
   0b000110010,
   0b100100100,
   0b100100010,
   0b100010010,
   0b011001110,
   0b001101110,
   0b001100111,
   0b011100110,
   0b001110110,
   0b001110011,
   0b100111001,
   0b100101110,
   0b100100111,
   0b101110010,
   0b100111010,
   0b110110111,
   0b110100110,
   0b110010110,
   0b110010011,
   0b110110010,
   0b110011010,
   0b110011001,
   0b101101100,
   0b101100011,
   0b100011011,
   0b010001100,
   0b000101100,
   0b000100011,
   0b011000100,
   0b000110100,
   0b000110001,
   0b101000100,
   0b100010100,
   0b100010001,
   0b011011100,
   0b011000111,
   0b000110111,
   0b011101100,
   0b011100011,
   0b000111011,
   0b110111011,
   0b101000111,
   0b100010111,
   0b101110100,
   0b101110001,
   0b101110111,
   0b110101100,
   0b110100011,
   0b110001011,
   0b110110100,
   0b110110001,
   0b110001101,
   0b110111101,
   0b100100001,
   0b111000101,
   0b010011000,
   0b010000110,
   0b001011000,
   0b001000011,
   0b000010110,
   0b000010011,
   0b011001000,
   0b011000010,
   0b001101000,
   0b001100001,
   0b000011010,
   0b000011001,
   0b100001001,
   0b100101000,
   0b111011101,
   0b100001010,
   0b000111101,
   0b010011110,
   0b001011110,
   0b001001111,
   0b011110010,
   0b001111010,
   0b001111001,
   0b111010010,
   0b111001010,
   0b111001001,
   0b101101111,
   0b101111011,
   0b111011011,
   0b010111100,
   0b010001111,
   0b000101111,
   0b011110100,
   0b011110001,
   0b111010100,
   0b111010001,
   0b011101111,
   0b011110111,
   0b110101111,
   0b111010111
 ]

def branch(vals)
  tree = Array.new(2)
  vals.each_with_index do |v, i|
    arr = tree
    (0..8).map do |n|
      x = (v >> n) & 1
      arr[x] ||= Array.new(2)
      if n == 8
        arr[x] = i
      else
        arr = arr[x]
      end
    end
  end
  return tree
end

tree = branch(values)

def treestr(arr)
  elem = []
  arr.each do |e|
    if e.nil?
      next
    elsif Array === e
      elem << treestr(e)
    else
      elem << e.to_s
    end
  end
  return "{#{elem.join(',')}}"
end

puts treestr(tree)
